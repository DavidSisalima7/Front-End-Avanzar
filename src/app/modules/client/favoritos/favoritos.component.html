<div class="flex flex-col flex-auto min-w-0">
    <!-- Main -->
    <div class="flex flex-auto justify-center w-full max-w-7xl mx-auto p-6 sm:p-8">
        <!-- Column -->
        <div class="flex flex-col items-start">
            <ng-container *ngIf="publicaciones$ | async as publicaciones">
                <ng-container *ngIf="publicaciones.length > 0; else noPublicaciones">
                    <!-- Cambio de la estructura para crear dos columnas -->
                    <div class="flex flex-wrap -mx-4">
                        <ng-container *ngFor="let publicacion of publicaciones; trackBy: trackByFn">
                            <div class="flex w-full md:w-1/2 px-4 mb-8"
                                [ngClass]="{'solo-una-tarjeta': publicaciones.length === 1}">
                                <fuse-card
                                    class="flex flex-col md:flex-row max-w-40 md:max-w-140 w-full filter-shopping">
                                    <div class="flex-0 w-80 md:w-40">
                                        <ng-container *ngIf="
                                                publicacion.productos;
                                                else servicioMiniatura
                                            ">
                                            <img class="w-full h-full object-cover" *ngIf="
                                                    publicacion.productos
                                                        .miniaturaProducto
                                                " [src]="
                                                    publicacion.productos
                                                        .miniaturaProducto
                                                " alt="Card cover image" />
                                        </ng-container>
                                        <ng-template #servicioMiniatura>
                                            <img class="w-full h-full object-cover" *ngIf="
                                                    publicacion.servicios
                                                        .miniaturaServicio
                                                " [src]="
                                                    publicacion.servicios
                                                        .miniaturaServicio
                                                " alt="Card cover image" />
                                        </ng-template>
                                    </div>

                                    <div class="flex flex-col flex-auto m-8 mb-4">
                                        <div class="flex flex-col md:flex-row items-baseline justify-between">
                                            <div class="flex flex-col">
                                                <img class="w-10 h-10 rounded-full mr-4" *ngIf="
                                                        publicacion.vendedor
                                                            .usuario.avatar
                                                    " [src]="
                                                        publicacion.vendedor
                                                            .usuario.avatar
                                                    " alt="Card cover image" />
                                                <span class="font-semibold leading-none">
                                                    {{
                                                    publicacion.vendedor
                                                    .usuario.name
                                                    }}</span>
                                            </div>
                                            <div class="text-3xl font-semibold mt-4 md:mt-0 md:ml-6">
                                                <span class="text-sm text-secondary leading-none mt-1">{{
                                                    publicacion.tiempoTranscurrido
                                                    }}</span>
                                            </div>
                                        </div>


                                        <div class="text-md text-secondary mt-6">
                                            <div class="text-3xl font-semibold leading-none">
                                                {{
                                                publicacion.tituloPublicacion
                                                }}
                                            </div>
                                        </div>


                                        <div class="text-md text-secondary mt-6">
                                            <ng-container *ngIf="
                                                    publicacion.productos;
                                                    else servicioDescripcion
                                                ">
                                                {{
                                                publicacion.productos
                                                .descripcionProducto
                                                }}
                                            </ng-container>
                                            <ng-template #servicioDescripcion>
                                                {{
                                                publicacion.servicios
                                                .descripcionServicio ||
                                                "Precio no disponible"
                                                }}
                                            </ng-template>
                                        </div>


                                        <div class="text-md text-secondary mt-6">
                                            <div class="flex items-baseline">
                                                <div class="text-2xl font-semibold mt-2">
                                                    USD
                                                </div>
                                                <div class="text-2xl font-semibold mt-2">
                                                    <span matSuffix>$</span>
                                                    <ng-container *ngIf="
                                                            publicacion.productos;
                                                            else servicioPrecio
                                                        ">
                                                        {{
                                                        publicacion
                                                        .productos
                                                        .precioProducto
                                                        }}
                                                    </ng-container>
                                                    <ng-template #servicioPrecio>
                                                        {{
                                                        publicacion
                                                        .servicios
                                                        .precioServicio ||
                                                        "Precio no disponible"
                                                        }}
                                                    </ng-template>
                                                </div>
                                            </div>
                                        </div>


                                        <div class="flex items-center text-md mt-6">
                                            <span class="text-secondary whitespace-nowrap mr-3">Disponibles: </span>
                                            <div class="text-secondary">
                                                <ng-container *ngIf="
                                                            publicacion.productos;
                                                            else servicioTemplates
                                                        ">
                                                    <div class="hidden lg:flex items-center">
                                                        <div class="min-w-4">
                                                            {{
                                                            publicacion
                                                            .productos
                                                            .cantidadDisponible
                                                            }}
                                                        </div>
                                                        <div class="flex items-end ml-2 w-1 h-4 bg-red-200 rounded overflow-hidden"
                                                            *ngIf="
                                                                    publicacion
                                                                        .productos
                                                                        .cantidadDisponible <
                                                                    20
                                                                ">
                                                            <div class="flex w-full h-1/3 bg-red-600"></div>
                                                        </div>

                                                        <div class="flex items-end ml-2 w-1 h-4 bg-orange-200 rounded overflow-hidden"
                                                            *ngIf="
                                                                    publicacion
                                                                        .productos
                                                                        .cantidadDisponible >=
                                                                        20 &&
                                                                    publicacion
                                                                        .productos
                                                                        .cantidadDisponible <
                                                                        30
                                                                ">
                                                            <div class="flex w-full h-2/4 bg-orange-400"></div>
                                                        </div>
                                                        <!-- High stock -->
                                                        <div class="flex items-end ml-2 w-1 h-4 bg-green-100 rounded overflow-hidden"
                                                            *ngIf="
                                                                    publicacion
                                                                        .productos
                                                                        .cantidadDisponible >=
                                                                    30
                                                                ">
                                                            <div class="flex w-full h-full bg-green-400"></div>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                                <ng-template #servicioTemplates>
                                                    <div class="hidden lg:flex items-center">
                                                        <div class="min-w-4">
                                                            {{
                                                            publicacion
                                                            .servicios
                                                            .cantidadDisponible
                                                            }}
                                                        </div>
                                                        <div class="flex items-end ml-2 w-1 h-4 bg-red-200 rounded overflow-hidden"
                                                            *ngIf="
                                                                    publicacion
                                                                        .servicios
                                                                        .cantidadDisponible <
                                                                    20
                                                                ">
                                                            <div class="flex w-full h-1/3 bg-red-600"></div>
                                                        </div>

                                                        <div class="flex items-end ml-2 w-1 h-4 bg-orange-200 rounded overflow-hidden"
                                                            *ngIf="
                                                                    publicacion
                                                                        .servicios
                                                                        .cantidadDisponible >=
                                                                        20 &&
                                                                    publicacion
                                                                        .servicios
                                                                        .cantidadDisponible <
                                                                        30
                                                                ">
                                                            <div class="flex w-full h-2/4 bg-orange-400"></div>
                                                        </div>
                                                        <!-- High stock -->
                                                        <div class="flex items-end ml-2 w-1 h-4 bg-green-100 rounded overflow-hidden"
                                                            *ngIf="
                                                                    publicacion
                                                                        .servicios
                                                                        .cantidadDisponible >=
                                                                    30
                                                                ">
                                                            <div class="flex w-full h-full bg-green-400"></div>
                                                        </div>
                                                    </div>
                                                </ng-template>
                                            </div>

                                        </div>
                                        <hr class="w-full border-b mt-6 mb-4" />
                                        <div class="flex items-center md:mt-auto -mx-3">
                                            <a [href]="'https://api.whatsapp.com/send?phone=593' + publicacion.vendedor.usuario.persona.celular + '&text=Hola, ' + publicacion.vendedor.usuario.name + '%20quisiera%20adquirir%20el%20'+publicacion.categoria.nombreCategoria+'%20de%20la%20publicacion%20' + publicacion.tituloPublicacion"
                                                target="_blank" class="px-3 mr-1" mat-button [color]="'primary'">
                                                <mat-icon class="icon-size-5"
                                                    [svgIcon]="'heroicons_solid:shopping-cart'"></mat-icon>
                                                <span class="ml-2">Adquirir</span>
                                            </a>

                                            <button class="ml-auto" mat-icon-button>
                                                <mat-icon class="icon-size-5 text-hint" [svgIcon]="
                                                        'heroicons_solid:heart'
                                                    "></mat-icon>
                                            </button>

                                            <button mat-icon-button>
                                                <mat-icon class="icon-size-5 text-hint" [svgIcon]="
                                                        'heroicons_solid:arrows-right-left'
                                                    "></mat-icon>
                                            </button>
                                            <div class="flex items-center">
                                                <button class="px-3" mat-button [color]="'primary'"
                                                    (click)="openComposeDialog(publicacion.idPublicacion)">
                                                    <span class="mr-1">Detalles</span>
                                                    <mat-icon
                                                        class="icon-size-5 transition-transform ease-in-out duration-150 rotate-0"
                                                        [svgIcon]="
                                                            'heroicons_mini:chevron-down'
                                                        "></mat-icon>
                                                </button>
                                            </div>

                                        </div>
                                    </div>
                                </fuse-card>
                            </div>
                        </ng-container>
                    </div>
                </ng-container>
            </ng-container>
        </div>
    </div>
</div>